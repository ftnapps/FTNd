# Makefile for mbnntpd
# $Id: Makefile,v 1.11 2007/05/27 12:50:47 mbse Exp $

include ../Makefile.global

SRCS		= mbnntp.c openport.c ttyio.c auth.c commands.c rfc2ftn.c \
		  hash.c lhash.c msgflags.c mkftnhdr.c atoul.c
HDRS		= mbnntp.h openport.h ttyio.h auth.h commands.h rfc2ftn.h \
		  hash.h lhash.h msgflags.h mkftnhdr.h atoul.h
OBJS		= mbnntp.o openport.o ttyio.o auth.o commands.o rfc2ftn.o \
		  hash.o lhash.o msgflags.o mkftnhdr.o atoul.o
SLIBS		= ../lib/libmbse.a ../lib/libmsgbase.a ../lib/libdbase.a
OTHER		= Makefile

#############################################################################

.c.o:
		${CC} ${CFLAGS} ${INCLUDES} ${DEFINES} -c $<

all:		mbnntp


mbnntp:		${OBJS} ${SLIBS}
		${CC} -o mbnntp   ${OBJS} ${LDFLAGS} ${LIBS} ${SLIBS}

clean:
		rm -f mbnntp *.o *.h~ *.c~ core filelist Makefile.bak

install:	all
		${INSTALL} -c -s -g ${GROUP} -o ${OWNER} -m 4750 mbnntp   ${BINDIR}

filelist:	Makefile
		BASE=`pwd`; \
		BASE=`basename $${BASE}`; \
		(for f in ${SRCS} ${HDRS} ${OTHER} ;do echo ${PACKAGE}-${VERSION}/$${BASE}/$$f; done) >filelist

depend:
	@rm -f Makefile.bak; \
	mv Makefile Makefile.bak; \
	sed -e '/^# DO NOT DELETE/,$$d' Makefile.bak >Makefile; \
	${ECHO} '# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT' \
		>>Makefile; \
	${ECHO} '# Dependencies generated by make depend' >>Makefile; \
	for f in ${SRCS}; \
	do \
		${ECHO} "Dependencies for $$f:\c"; \
		${ECHO} "`basename $$f .c`.o:\c" >>Makefile; \
		for h in `sed -n -e \
			's/^#[ 	]*include[ 	]*"\([^"]*\)".*/\1/p' $$f`; \
		do \
			${ECHO} " $$h\c"; \
			${ECHO} " $$h\c" >>Makefile; \
		done; \
		${ECHO} " done."; \
		${ECHO} "" >>Makefile; \
	done; \
	${ECHO} '# End of generated dependencies' >>Makefile

# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT
# Dependencies generated by make depend
mbnntp.o: ../config.h ../lib/mbselib.h ../lib/users.h ../lib/mbsedb.h ../lib/msg.h openport.h ttyio.h auth.h commands.h mbnntp.h
openport.o: ../config.h ../lib/mbselib.h ttyio.h openport.h
ttyio.o: ../config.h ../lib/mbselib.h ttyio.h
auth.o: ../config.h ../lib/mbselib.h ../lib/users.h mbnntp.h auth.h
commands.o: ../config.h ../lib/mbselib.h ../lib/users.h ../lib/msg.h ../lib/msgtext.h ../lib/mbsedb.h ttyio.h mbnntp.h rfc2ftn.h commands.h
rfc2ftn.o: ../config.h ../lib/mbselib.h ../lib/users.h ../lib/mbinet.h ../lib/mbsedb.h ../lib/msg.h ../lib/msgtext.h mkftnhdr.h hash.h msgflags.h rfc2ftn.h commands.h
hash.o: ../config.h ../lib/mbselib.h hash.h lhash.h
lhash.o: ../config.h ../lib/mbselib.h lhash.h
msgflags.o: ../config.h ../lib/mbselib.h msgflags.h
mkftnhdr.o: ../config.h ../lib/mbselib.h ../lib/users.h ../lib/mbsedb.h atoul.h hash.h msgflags.h mkftnhdr.h
atoul.o: ../config.h ../lib/mbselib.h atoul.h
# End of generated dependencies
