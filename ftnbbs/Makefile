# Makefile for ftnbbs under Linux
# Copyright (c) 2012 by M. Broek.
# Copyright (c) 1998, 2001 by M. Broek.

include ../Makefile.global

SRCS		= signature.c filesub.c language.c mib.c \
		  msgutil.c oneline.c morefile.c \
		  email.c fsedit.c page.c \
		  bye.c funcs.c mail.c term.c ttyio.c openport.c \
		  newuser.c pinfo.c timecheck.c change.c transfer.c \
		  exitinfo.c ftnbbs.c menu.c pop3.c lastcallers.c \
		  timeout.c chat.c file.c misc.c \
		  offline.c user.c ftnnewusr.c input.c whoson.c \
		  door.c dispfile.c userlist.c timestats.c logentry.c \
		  ymsend.c ymrecv.c zmmisc.c zmsend.c zmrecv.c
HDRS		= signature.h filesub.h language.h ftnbbs.h misc.h offline.h \
		  timeout.h email.h fsedit.h mib.h \
		  msgutil.h oneline.h user.h bye.h morefile.h \
		  funcs.h mail.h page.h term.h ttyio.h openport.h \
		  change.h exitinfo.h newuser.h \
		  pinfo.h chat.h file.h menu.h transfer.h \
		  pop3.h timecheck.h ftnnewusr.h input.h whoson.h \
		  door.h dispfile.h userlist.h timestats.h logentry.h lastcallers.h \
		  ymsend.h ymrecv.h zmmisc.h zmsend.h zmrecv.h
MBSEBBS_OBJS	= signature.o chat.o file.o funcs.o mail.o menu.o mib.o \
		  misc.o pinfo.o oneline.o page.o fsedit.o transfer.o \
		  bye.o change.o ftnbbs.o timeout.o user.o timecheck.o \
		  exitinfo.o filesub.o offline.o language.o msgutil.o \
		  pop3.o email.o input.o whoson.o door.o dispfile.o userlist.o timestats.o \
		  logentry.o morefile.o lastcallers.o term.o ttyio.o openport.o \
		  ymsend.o ymrecv.o zmmisc.o zmsend.o zmrecv.o
MBSEBBS_LIBS	= ../lib/libftnd.a ../lib/libmsgbase.a ../lib/libdbase.a ../lib/libftninet.a ../lib/libnodelist.a
MBNEWUSR_OBJS	= ftnnewusr.o newuser.o language.o timeout.o dispfile.o oneline.o ttyio.o mib.o \
		  timecheck.o input.o exitinfo.o funcs.o misc.o change.o door.o term.o openport.o \
		  filesub.o mail.o email.o msgutil.o pop3.o fsedit.o whoson.o
MBNEWUSR_LIBS	= ../lib/libftnd.a ../lib/libmsgbase.a ../lib/libdbase.a ../lib/libftninet.a ../lib/libnodelist.a
OTHER		= Makefile
TARGET		= ftnbbs ftnnewusr

#############################################################################################################

.c.o:
		${CC} ${CFLAGS} ${INCLUDES} ${DEFINES} -c $<

all:		${TARGET}

clean: 
		rm -f ${TARGET} *.o *.h~ *.c~ core filelist Makefile.bak

ftnbbs:	${MBSEBBS_OBJS} ${MBSEBBS_LIBS}
		${CC} -o ftnbbs ${MBSEBBS_OBJS} ${LDFLAGS} ${LIBS} ${MBSEBBS_LIBS}

ftnnewusr:	${MBNEWUSR_OBJS} ${MBNEWUSR_LIBS}
		${CC} -o ftnnewusr ${MBNEWUSR_OBJS} ${LDFLAGS} ${LIBS} ${MBNEWUSR_LIBS}

install:	all
		@if [ "`id -un`" != "root" ] ; then \
			echo; echo " Must be root to install!"; echo; exit 3; \
		fi
		${INSTALL} -c -s -o ${OWNER} -g ${GROUP}  -m 0750 ftnbbs   ${BINDIR}
		${INSTALL} -c -s -o ${OWNER} -g ${GROUP}  -m 6750 ftnnewusr  ${BINDIR}
		@rm -f ${ETCDIR}/bbslist.data

filelist:	Makefile
		BASE=`pwd`; \
		BASE=`basename $${BASE}`; \
		(for f in ${SRCS} ${HDRS} ${OTHER} ; do echo ${PACKAGE}-${VERSION}/$${BASE}/$$f; done) >filelist

depend:
		@rm -f Makefile.bak; \
		mv Makefile Makefile.bak; \
		sed -e '/^# DO NOT DELETE/,$$d' Makefile.bak >Makefile; \
		${ECHO} '# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT' \
		>>Makefile; \
		${ECHO} '# Dependencies generated by make depend' >>Makefile; \
		for f in ${SRCS}; \
		do \
		${ECHO} "Dependencies for $$f:\c"; \
		${ECHO} "`basename $$f .c`.o:\c" >>Makefile; \
		for h in `sed -n -e \
			's/^#[ 	]*include[ 	]*"\([^"]*\)".*/\1/p' $$f`; \
		do \
			${ECHO} " $$h\c"; \
			${ECHO} " $$h\c" >>Makefile; \
		done; \
		${ECHO} " done."; \
		${ECHO} "" >>Makefile; \
		done; \
		${ECHO} '# End of generated dependencies' >>Makefile

# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT
# Dependencies generated by make depend
signature.o: ../config.h ../lib/ftnselib.h ../lib/ftnd.h ../lib/users.h signature.h funcs.h input.h language.h timeout.h term.h ttyio.h
filesub.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/ftnddb.h filesub.h funcs.h language.h input.h misc.h timeout.h exitinfo.h change.h term.h ttyio.h
language.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h input.h language.h term.h ttyio.h
mib.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h mib.h
msgutil.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/msgtext.h ../lib/msg.h oneline.h msgutil.h
oneline.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h oneline.h funcs.h input.h language.h term.h ttyio.h
morefile.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h input.h language.h morefile.h timeout.h term.h ttyio.h
email.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/msgtext.h ../lib/msg.h ../lib/mbinet.h exitinfo.h language.h mail.h timeout.h msgutil.h input.h email.h whoson.h term.h ttyio.h
fsedit.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h mail.h input.h language.h timeout.h pinfo.h fsedit.h term.h ttyio.h
page.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h dispfile.h input.h chat.h page.h timeout.h mail.h language.h term.h ttyio.h
bye.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/nodelist.h dispfile.h misc.h language.h bye.h term.h openport.h ttyio.h mib.h
funcs.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/msgtext.h ../lib/msg.h funcs.h term.h ttyio.h
mail.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/nodelist.h ../lib/msgtext.h ../lib/msg.h mail.h funcs.h input.h language.h misc.h timeout.h oneline.h exitinfo.h fsedit.h filesub.h msgutil.h pop3.h email.h door.h whoson.h term.h ttyio.h openport.h
term.o: ../config.h ../lib/ftndlib.h ../lib/users.h term.h ttyio.h
ttyio.o: ../config.h ../lib/ftndlib.h ttyio.h
openport.o: ../config.h ../lib/ftndlib.h ttyio.h openport.h zmmisc.h
newuser.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h funcs.h input.h newuser.h language.h timeout.h change.h dispfile.h term.h ttyio.h openport.h
pinfo.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h pinfo.h input.h term.h ttyio.h
timecheck.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h timecheck.h funcs.h bye.h exitinfo.h language.h input.h term.h ttyio.h
change.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h change.h dispfile.h funcs.h input.h language.h misc.h timeout.h exitinfo.h bye.h term.h ttyio.h
transfer.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h transfer.h change.h whoson.h funcs.h term.h ttyio.h filesub.h language.h openport.h timeout.h zmmisc.h zmsend.h zmrecv.h ymsend.h ymrecv.h
exitinfo.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h funcs.h input.h language.h oneline.h misc.h bye.h timeout.h timecheck.h exitinfo.h
ftnbbs.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/msg.h ftnbbs.h user.h dispfile.h language.h menu.h misc.h bye.h timeout.h funcs.h term.h ttyio.h openport.h input.h
menu.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h oneline.h mail.h change.h chat.h file.h funcs.h input.h misc.h timeout.h menu.h page.h pinfo.h bye.h timecheck.h whoson.h language.h offline.h email.h door.h dispfile.h userlist.h timestats.h logentry.h morefile.h lastcallers.h signature.h term.h ttyio.h
pop3.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/mbinet.h ../lib/msgtext.h ../lib/msg.h msgutil.h pop3.h term.h ttyio.h
lastcallers.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h input.h language.h lastcallers.h term.h ttyio.h
timeout.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/msg.h timeout.h funcs.h bye.h filesub.h language.h term.h
chat.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h chat.h funcs.h input.h language.h misc.h whoson.h term.h ttyio.h timeout.h
file.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/ftnddb.h filesub.h file.h funcs.h input.h language.h misc.h timeout.h exitinfo.h whoson.h change.h dispfile.h term.h ttyio.h openport.h transfer.h
misc.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/msg.h funcs.h input.h language.h misc.h timeout.h exitinfo.h ttyio.h term.h
offline.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/bluewave.h ../lib/msgtext.h ../lib/msg.h mail.h funcs.h input.h language.h file.h filesub.h exitinfo.h timeout.h msgutil.h pop3.h offline.h whoson.h term.h ttyio.h openport.h transfer.h
user.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h timeout.h user.h dispfile.h funcs.h input.h misc.h bye.h file.h mail.h change.h menu.h exitinfo.h language.h offline.h email.h term.h ttyio.h
mbnewusr.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ftnnewusr.h funcs.h input.h language.h misc.h timeout.h newuser.h term.h ttyio.h openport.h
input.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h input.h timeout.h language.h term.h ttyio.h
whoson.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h input.h language.h exitinfo.h whoson.h term.h ttyio.h
door.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h language.h input.h timeout.h exitinfo.h whoson.h door.h term.h ttyio.h openport.h
dispfile.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/msgtext.h ../lib/msg.h funcs.h language.h oneline.h misc.h timeout.h timecheck.h exitinfo.h mail.h email.h input.h dispfile.h filesub.h term.h ttyio.h
userlist.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h userlist.h language.h input.h timeout.h term.h ttyio.h
timestats.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h timestats.h funcs.h language.h input.h exitinfo.h term.h ttyio.h
logentry.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h logentry.h
ymsend.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ttyio.h zmmisc.h transfer.h openport.h timeout.h term.h ymsend.h
ymrecv.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ttyio.h timeout.h transfer.h zmmisc.h zmrecv.h ymsend.h ymrecv.h
zmmisc.o: ../config.h ../lib/ftndlib.h ttyio.h input.h zmmisc.h
zmsend.o: ../config.h ../lib/ftndlib.h ttyio.h zmmisc.h transfer.h openport.h timeout.h
zmrecv.o: ../config.h ../lib/ftndlib.h ../lib/users.h ttyio.h transfer.h zmmisc.h zmrecv.h ymrecv.h openport.h timeout.h input.h
# End of generated dependencies
