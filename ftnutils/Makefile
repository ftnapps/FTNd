# Makefile for FTND Utilities under Linux
# Copyright (c) 2012 by Robert James Clay.
# Copyright (c) 1998, 2004 by M. Broek.

include ../Makefile.global

SRCS		= ftnall.c dlcount.c ftnlang.c ftnstat.c ftnsnmp.c ftntoberep.c ftnuser.c ftnbw.c
HDRS		= ftnall.h dlcount.h ftnstat.h ftnsnmp.h ftnuser.h
MBALL_OBJS	= ftnall.o dlcount.o
MBALL_LIBS	= ../lib/libftnd.a ../lib/libdbase.a
MBLANG_OBJS	= ftnlang.o
MBLANG_LIBS	= ../lib/libftnd.a ../lib/libdbase.a
MBSTAT_OBJS	= ftnstat.o
MBSTAT_LIBS	= ../lib/libftnd.a ../lib/libdbase.a
MBSNMP_OBJS	= ftnsnmp.o
MBSNMP_LIBS	= ../lib/libftnd.a ../lib/libdbase.a
MBTOBE_OBJS	= ftntoberep.o
MBTOBE_LIBS	= ../lib/libftnd.a ../lib/libdbase.a
MBUSER_OBJS	= ftnuser.o
MBUSER_LIBS	= ../lib/libftnd.a ../lib/libdbase.a
MBBW_OBJS	= ftnbw.o
MBBW_LIBS	= ../lib/libftnd.a ../lib/libdbase.a
OTHER		= Makefile
TARGET		= ftnall ftnlang ftnstat ftnsnmp ftntoberep ftnuser ftnbw

#############################################################################################################

.c.o:
		${CC} ${CFLAGS} ${INCLUDES} ${DEFINES} -c $<

all:		${TARGET}

clean: 
		rm -f ${TARGET} *.o *.h~ *.c~ core filelist Makefile.bak

ftnall:		${MBALL_OBJS} ${MBALL_LIBS}
		${CC} -o ftnall   ${MBALL_OBJS} ${LDFLAGS} ${LIBS} ${MBALL_LIBS}

ftnlang:		${MBLANG_OBJS} ${MBLANG_LIBS}
		${CC} -o ftnlang  ${MBLANG_OBJS} ${LDFLAGS} ${LIBS} ${MBLANG_LIBS}

ftnstat:		${MBSTAT_OBJS} ${MBSTAT_LIBS}
		${CC} -o ftnstat ${MBSTAT_OBJS} ${LDFLAGS} ${LIBS} ${MBSTAT_LIBS}

ftnsnmp:		${MBSNMP_OBJS} ${MBSNMP_LIBS}
		${CC} -o ftnsnmp ${MBSNMP_OBJS} ${LDFLAGS} ${LIBS} ${MBSNMP_LIBS}

ftntoberep:	${MBTOBE_OBJS} ${MBTOBE_LIBS}
		${CC} -o ftntoberep ${MBTOBE_OBJS} ${LDFLAGS} ${LIBS} ${MBTOBE_LIBS}

ftnuser:		${MBUSER_OBJS} ${MBUSER_LIBS}
		${CC} -o ftnuser ${MBUSER_OBJS} ${LDFLAGS} ${LIBS} ${MBUSER_LIBS}

ftnbw:		${MBBW_OBJS} ${MBBW_LIBS}
		${CC} -o ftnbw ${MBBW_OBJS} ${LDFLAGS} ${LIBS} ${MBBW_LIBS}

install:	all
		@if [ "`id -un`" != "root" ] ; then \
			echo; echo " Must be root to install!"; echo; exit 3; \
		fi
		${INSTALL} -c -s -o ${OWNER} -g ${GROUP}  -m 0700 ftnall     ${BINDIR}
		${INSTALL} -c -s -o ${OWNER} -g ${GROUP}  -m 0700 ftnlang    ${BINDIR}
		${INSTALL} -c -s -o ${OWNER} -g ${GROUP}  -m 0750 ftnstat    ${BINDIR}
		${INSTALL} -c -s -o ${OWNER} -g ${GROUP}  -m 4750 ftnsnmp    ${BINDIR}
		${INSTALL} -c -s -o ${OWNER} -g ${GROUP}  -m 0700 ftntoberep ${BINDIR}
		${INSTALL} -c -s -o ${ROWNER} -g ${RGROUP} -m 6711 ftnuser    ${BINDIR}
		${INSTALL} -c -s -o ${OWNER} -g ${GROUP}  -m 0750 ftnbw      ${BINDIR}
		@rm -f ftnchat

filelist:	Makefile
		BASE=`pwd`; \
		BASE=`basename $${BASE}`; \
		(for f in ${SRCS} ${HDRS} ${OTHER} ; do echo ${PACKAGE}-${VERSION}/$${BASE}/$$f; done) >filelist

depend:
		@rm -f Makefile.bak; \
		mv Makefile Makefile.bak; \
		sed -e '/^# DO NOT DELETE/,$$d' Makefile.bak >Makefile; \
		${ECHO} '# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT' \
		>>Makefile; \
		${ECHO} '# Dependencies generated by make depend' >>Makefile; \
		for f in ${SRCS}; \
		do \
		${ECHO} "Dependencies for $$f:\c"; \
		${ECHO} "`basename $$f .c`.o:\c" >>Makefile; \
		for h in `sed -n -e \
			's/^#[ 	]*include[ 	]*"\([^"]*\)".*/\1/p' $$f`; \
		do \
			${ECHO} " $$h\c"; \
			${ECHO} " $$h\c" >>Makefile; \
		done; \
		${ECHO} " done."; \
		${ECHO} "" >>Makefile; \
		done; \
		${ECHO} '# End of generated dependencies' >>Makefile

# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT
# Dependencies generated by make depend
ftnall.o: ../config.h ../lib/ftndlib.h ../lib/ftnd.h ../lib/users.h ../lib/ftnddb.h dlcount.h ftnall.h
dlcount.o: ../config.h ../lib/ftndlib.h ../lib/users.h ../lib/ftnddb.h dlcount.h
ftnlang.o: ../config.h ../lib/ftndlib.h
ftnstat.o: ../config.h ../lib/ftndlib.h ../lib/users.h ../lib/ftnddb.h ftnstat.h
ftnsnmp.o: ../config.h ../lib/ftndlib.h ../lib/users.h ../lib/ftnddb.h ftnsnmp.h
ftntoberep.o: ../config.h ../lib/ftndlib.h
ftnuser.o: ../config.h ../lib/ftndlib.h ../lib/users.h ../lib/ftnddb.h ftnuser.h
ftnbw.o: ../config.h ../lib/ftndlib.h ../lib/bluewave.h
# End of generated dependencies
