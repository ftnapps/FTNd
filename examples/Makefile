# Copyright (c) M. Broek, 1997-2001
# $Id: Makefile,v 1.26 2008/12/01 19:26:29 mbse Exp $

include ../Makefile.global

OTHER		= Makefile header.txt footer.txt \
		  menus-en.tar txtfiles-en.tar templates-en.tar \
		  menus-es.tar txtfiles-es.tar templates-es.tar \
		  menus-de.tar txtfiles-de.tar templates-de.tar \
		  templates-nl.tar

#####################################################################################

.c.o:
		${CC} ${CFLAGS} ${INCLUDES} ${DEFINES} -c $<

all:

help:
		@echo "Installation help for the example files"
		@echo ""
		@echo "make install               Installs everything not yet installed"
		@echo "make install-force         Reinstalls all menus, textfiles and macros"
		@echo ""
		@echo "make english-menus         Force (re)installation of English menus"
		@echo "make english-txtfiles      Force (re)installation of English textfiles"
		@echo "make english-macros        Force (re)installation of English macros"
		@echo "make english               Force (re)installation of all English files"
		@echo ""
		@echo "make macros                Force (re)installation of all macro templates"
		@echo ""
		@echo "You may replace the word english above with spanish, german or dutch"

english-menus:
		@tar xfC menus-en.tar ${PREFIX}/share/int/menus/en
		@echo "Installed default English menus"

english-txtfiles:
		@tar xfC txtfiles-en.tar ${PREFIX}/share/int/txtfiles/en
		@echo "Installed default English txtfiles"

english-macros:
		@tar xfC templates-en.tar ${PREFIX}/share/int/macro/en
		@echo "Installed default English macro files"

english:	english-menus english-macros english-txtfiles


spanish-menus:
		@tar xfC menus-es.tar ${PREFIX}/share/int/menus/es
		@echo "Installed default Spanish menus"

spanish-txtfiles:
		@tar xfC txtfiles-es.tar ${PREFIX}/share/int/txtfiles/es
		@echo "Installed default Spanish txtfiles"

spanish-macros:
		@tar xfC templates-es.tar ${PREFIX}/share/int/macro/es
		@echo "Installed default Spanish macro files"

spanish:	spanish-menus spanish-txtfiles spanish-macros


german-menus:
		@tar xfC menus-de.tar ${PREFIX}/share/int/menus/de
		@echo "Installed default German menus"

german-txtfiles:
		@tar xfC txtfiles-de.tar ${PREFIX}/share/int/txtfiles/de
		@echo "Installed default German txtfiles"

german-macros:
		@tar xfC templates-de.tar ${PREFIX}/share/int/macro/de
		@echo "Installed default German macro files"

german:		german-menus german-txtfiles german-macros


dutch-macros:
		@tar xfC templates-nl.tar ${PREFIX}/share/int/macro/nl
		@echo "Installed default Dutch macro files"

dutch:		dutch-macros

galego:


install-force:	english spanish dutch german galego

macros:		english-macros spanish-macros german-macros dutch-macros


install:
		@if [ ! -f ${ETCDIR}/header.txt ]; then \
			${INSTALL} -c -o ${OWNER} -g ${GROUP} -m 0644 header.txt ${ETCDIR} ; \
			echo "${INSTALL} -c -o ${OWNER} -g ${GROUP} -m 0644 header.txt ${ETCDIR}" ; \
		fi
		@if [ ! -f ${ETCDIR}/footer.txt ]; then \
			${INSTALL} -c -o ${OWNER} -g ${GROUP} -m 0644 footer.txt ${ETCDIR} ; \
			echo "${INSTALL} -c -o ${OWNER} -g ${GROUP} -m 0644 footer.txt ${ETCDIR}" ; \
		fi
		@if [ ! -f ${PREFIX}/share/int/menus/en/main.mnu ];    then ${MAKE} -s english-menus ;    fi
		@if [ ! -f ${PREFIX}/share/int/txtfiles/en/main.ans ]; then ${MAKE} -s english-txtfiles ; fi
		@if [ ! -f ${PREFIX}/share/int/macro/en/html.tic ];    then ${MAKE} -s english-macros ;   fi
		@if [ ! -f ${PREFIX}/share/int/menus/es/main.mnu ];    then ${MAKE} -s spanish-menus ;    fi
		@if [ ! -f ${PREFIX}/share/int/txtfiles/es/main.ans ]; then ${MAKE} -s spanish-txtfiles ; fi
		@if [ ! -f ${PREFIX}/share/int/macro/es/html.tic ];    then ${MAKE} -s spanish-macros ;   fi
		@if [ ! -f ${PREFIX}/share/int/menus/de/main.mnu ];    then ${MAKE} -s german-menus ;     fi
		@if [ ! -f ${PREFIX}/share/int/txtfiles/de/main.ans ]; then ${MAKE} -s german-txtfiles ;  fi
		@if [ ! -f ${PREFIX}/share/int/macro/de/html.tic ];    then ${MAKE} -s german-macros ;    fi
		@if [ ! -f ${PREFIX}/share/int/macro/nl/html.tic ];    then ${MAKE} -s dutch-macros ;     fi

clean:
		rm -f *.h~ *.c~ core filelist Makefile.bak

filelist:	Makefile
		BASE=`pwd`; \
		BASE=`basename $${BASE}`; \
		(for f in ${SRCS} ${HDRS} ${OTHER} ;do echo ${PACKAGE}-${VERSION}/$${BASE}/$$f; done) >filelist

depend:
	@rm -f Makefile.bak; \
	mv Makefile Makefile.bak; \
	sed -e '/^# DO NOT DELETE/,$$d' Makefile.bak >Makefile; \
	${ECHO} '# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT' \
		>>Makefile; \
	${ECHO} '# Dependencies generated by make depend' >>Makefile; \
	for f in ${SRCS}; \
	do \
		${ECHO} "Dependencies for $$f:\c"; \
		${ECHO} "`basename $$f .c`.o:\c" >>Makefile; \
		for h in `sed -n -e \
			's/^#[  ]*include[      ]*"\([^"]*\)".*/\1/p' $$f`; \
		do \
			${ECHO} " $$h\c"; \
			${ECHO} " $$h\c" >>Makefile; \
		done; \
		${ECHO} " done."; \
		${ECHO} "" >>Makefile; \
	done; \
	${ECHO} '# End of generated dependencies' >>Makefile

# DO NOT DELETE THIS LINE - MAKE DEPEND RELIES ON IT
# Dependencies generated by make depend
# End of generated dependencies
